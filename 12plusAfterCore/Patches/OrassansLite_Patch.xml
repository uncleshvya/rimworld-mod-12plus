<?xml version="1.0" encoding="utf-8" ?>

<Patch>

	<!-- исправление согласно концепции «12+» -->

	<Operation MayRequire="dianawinters.OrassansLite" Class="PatchOperationSequence">
		<success>Always</success>
		<operations>

			<!-- шёрстка: -->
			<li Class="PatchOperationAttributeSet">
				<xpath>Defs/ThingDef[defName = "Leather_Orassan"]</xpath>
				<attribute>ParentName</attribute>
				<value>WoolBase</value>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[defName = "Leather_Orassan"]/graphicData/color</xpath>
				<value>
					<color>(147, 140, 129)</color>
					<drawSize>0.5</drawSize>
				</value>
			</li>

			<!-- расы: -->
			<li Class="PatchOperationAdd">
				<xpath>Defs/AlienRace.ThingDef_AlienRace[
				defName = "Alien_Orassan" or
				defName = "Alien_OrassanHumanHybrid"
				]/race</xpath>
				<value>
					<useMeatFrom>Human</useMeatFrom>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/AlienRace.ThingDef_AlienRace[
				defName = "Alien_Orassan" or
				defName = "Alien_OrassanHumanHybrid"
				]/alienRace/generalSettings</xpath>
				<value>
					<disallowedTraits>
						<li> <defName>Asexual</defName> </li>
						<li> <defName>Bisexual</defName> </li>
						<li> <defName>Cannibal</defName> </li>
						<li> <defName>Gay</defName> </li>
						<li> <defName>Masochist</defName> </li>
						<li> <defName>Pyromaniac</defName> </li>
					</disallowedTraits>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/AlienRace.ThingDef_AlienRace[
				defName = "Alien_Orassan" or
				defName = "Alien_OrassanHumanHybrid"
				]/alienRace/thoughtSettings/cannotReceiveThoughts</xpath>
				<value>
					<li>ButcheredHumanlikeCorpse</li>
					<li>KilledHumanlikeBloodlust</li>
					<li>KnowButcheredHumanlikeCorpse</li>
					<li>MasochistPain</li>
					<li>PyromaniacHappy</li>
					<li>WitnessedDeathBloodlust</li>
				</value>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/AlienRace.ThingDef_AlienRace[
				defName = "Alien_Orassan" or
				defName = "Alien_OrassanHumanHybrid"
				]/statBases/LeatherAmount</xpath>
				<value>
					<LeatherAmount>0</LeatherAmount>
					<MeatAmount>0</MeatAmount>
					<BoneAmount MayRequire="sihv.rombones">0</BoneAmount>
				</value>
			</li>

			<!-- отменяю действие патча, удаляя а потом перезаписывая параметр
			\Mods\OrassansLite\1.2\Patches\meals.xml -->
			<li Class="PatchOperationRemove">
				<xpath>Defs/RecipeDef[@Name = "CookMealBase"]/defaultIngredientFilter/disallowedThingDefs</xpath>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/RecipeDef[@Name = "CookMealBase"]/defaultIngredientFilter</xpath>
				<value>
					<disallowedThingDefs>
						<li>Meat_Human</li>
						<li>Meat_Megaspider</li>
						<li>InsectJelly</li>
					</disallowedThingDefs>
				</value>
			</li>

			<!-- напиток: -->
			<li Class="PatchOperationAttributeSet">
				<xpath>Defs/ThingDef[defName = "Catberryjuice"]</xpath>
				<attribute>ParentName</attribute>
				<value>ResourceBase</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "Catberryjuice"]</xpath>
				<value>
					<thingCategories>
						<li>Foods</li>
					</thingCategories>
				</value>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[defName = "Catberryjuice"]/ingestible</xpath>
				<value>
					<ingestible>
						<preferability>DesperateOnly</preferability>
						<foodType>Fluid, Processed</foodType>
						<joyKind>Gluttonous</joyKind>
						<joy>0.15</joy>
						<nurseable>true</nurseable>
						<ingestSound>Ingest_Beer</ingestSound>
						<ingestHoldOffsetStanding>
							<northDefault>
								<offset>(0.18,0,0)</offset>
							</northDefault>
						</ingestHoldOffsetStanding>
						<ingestCommandString>Drink {0}</ingestCommandString>
						<ingestReportString>Drinking {0}.</ingestReportString>
					</ingestible>
				</value>
			</li>
			<li Class="PatchOperationRemove">
				<xpath>Defs/ThingDef[defName = "Catberryjuice"]/comps/li[1]</xpath>
			</li>

			<!-- мятное пирожное: -->
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[defName = "CatnipJoint"]</xpath>
				<value>
					<ThingDef ParentName="ResourceBase">
						<defName>CatnipJoint</defName>
						<label>mint cake</label>
						<description>A tasty curds based cake with orassan catnip leaves added. It is rather nutritious and fulfills the need for recreation.</description>
						<thingCategories>
							<li>Foods</li>
						</thingCategories>
						<graphicData>
							<texPath>Things/Item/Drug/CatJoint</texPath>
							<graphicClass>Graphic_StackCount</graphicClass>
							<drawSize>0.75</drawSize>
						</graphicData>
						<stackLimit>8</stackLimit>
						<rotatable>false</rotatable>
						<statBases>
							<Mass>0.2</Mass>
							<WorkToMake>500</WorkToMake>
							<MarketValue>14</MarketValue>
							<Nutrition>0.4</Nutrition>
							<Flammability>1</Flammability>
						</statBases>
						<techLevel>Neolithic</techLevel>
						<ingestible>
							<preferability>DesperateOnly</preferability>
							<foodType>Processed</foodType>
							<joyKind>Gluttonous</joyKind>
							<joy>0.18</joy>
							<nurseable>true</nurseable>
							<ingestSound>Meal_Eat</ingestSound>
							<ingestHoldOffsetStanding>
								<northDefault>
									<offset>(0.35,0,0.1)</offset>
								</northDefault>
							</ingestHoldOffsetStanding>
							<ingestCommandString>Eat {0}</ingestCommandString>
							<ingestReportString>Eating {0}.</ingestReportString>
						</ingestible>
						<recipeMaker>
							<recipeUsers>
								<li>FueledStove</li>
								<li>ElectricStove</li>
							</recipeUsers>
							<workSpeedStat>CookSpeed</workSpeedStat>
							<workSkill>Cooking</workSkill>
							<skillRequirements>
								<Cooking>6</Cooking>
							</skillRequirements>
							<bulkRecipeCount>4</bulkRecipeCount>
						</recipeMaker>
						<costList>
							<CatnipLeaves>8</CatnipLeaves>
							<Milk>8</Milk>
						</costList>
						<comps>
							<li Class="CompProperties_Rottable">
								<daysToRotStart>14</daysToRotStart>
								<rotDestroys>true</rotDestroys>
							</li>
						</comps>
						<tickerType>Rare</tickerType>
					</ThingDef>
				</value>
			</li>

			<!-- исправлена неточность, сообщите разработчику, что 2 рецепта устарели: -->

			<li Class="PatchOperationRemove">
				<xpath>Defs/RecipeDef[
				defName = "MakeCatnipJoint5" or
				defName = "MakeCatnipJoint15"
				]</xpath>
			</li>

			<!-- исправлена неточность, сообщите разработчику, что иначе медпроцедур в 2 раза больше нужного: -->

			<li Class="PatchOperationRemove">
				<xpath>Defs/AlienRace.ThingDef_AlienRace[
				defName = "Alien_Orassan" or
				defName = "Alien_OrassanHumanHybrid"
				]/recipes</xpath>
			</li>

			<!-- исправлена неточность, сообщите разработчику, что иначе лёд орассан не удаляется: -->

			<li Class="PatchOperationAdd">
				<xpath>Defs/TerrainDef[defName = "OrassanSoil"]</xpath>
				<value>
					<layerable>true</layerable>
				</value>
			</li>

			<!-- уменьшение хвостов в полтора раза, сообщите разработчику, вдруг ей тоже понравится: -->
			<li Class="PatchOperationReplace">
				<xpath>Defs/AlienRace.ThingDef_AlienRace[
				defName = "Alien_Orassan" or
				defName = "Alien_OrassanHumanHybrid"
				]/alienRace/generalSettings/alienPartGenerator/bodyAddons/li[1]/drawSize/text()</xpath>
				<value>0.5</value>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/AlienRace.ThingDef_AlienRace[
				defName = "Alien_Orassan" or
				defName = "Alien_OrassanHumanHybrid"
				]/alienRace/generalSettings/alienPartGenerator/bodyAddons/li[1]/offsets/north/bodyTypes</xpath>
				<value>
					<bodyTypes>
						<Male>(-0.02,0.1)</Male>
						<Female>(-0.02,0.1)</Female>
						<Thin>(-0.02,0.1)</Thin>
						<Hulk>(-0.02,0)</Hulk>
					</bodyTypes>
				</value>
			</li>

			<!-- выровнял хвосты для кошек: -->
			<li Class="PatchOperationReplace">
				<xpath>Defs/AlienRace.ThingDef_AlienRace[
				defName = "Alien_Orassan"
				]/alienRace/generalSettings/alienPartGenerator/bodyAddons/li[1]/offsets/east/bodyTypes</xpath>
				<value>
					<bodyTypes>
						<Male>(-0.05,-0.1)</Male>
						<Female>(-0.05,-0.05)</Female>
						<Thin>(-0.05,-0.1)</Thin>
						<Hulk>(0.1,-0.25)</Hulk>
					</bodyTypes>
				</value>
			</li>

			<!-- аналогично для гибридов, только чуть пододвинул хвосты: -->
			<li Class="PatchOperationReplace">
				<xpath>Defs/AlienRace.ThingDef_AlienRace[
				defName = "Alien_OrassanHumanHybrid"
				]/alienRace/generalSettings/alienPartGenerator/bodyAddons/li[1]/offsets/east/bodyTypes</xpath>
				<value>
					<bodyTypes>
						<Male>(0,-0.15)</Male>
						<Female>(0,-0.1)</Female>
						<Thin>(0,-0.15)</Thin>
						<Hulk>(0.15,-0.3)</Hulk>
					</bodyTypes>
				</value>
			</li>

			<!-- исправлена неточность, сообщите разработчику, что иначе часто вылезает красная ошибка предысторий. Решена проблема для силовиков орассан. И почему то пропала ошибка из-за имён: -->

			<li Class="PatchOperationAdd">
				<xpath>Defs/AlienRace.BackstoryDef[
				defName = "Orassan_EcumenopolisA" or
				defName = "Orassan_PsiPolice" or
				defName = "Orassan_PsiWarrior" or
				defName = "Orassan_Constructor" or
				defName = "Orassan_SEngineer" or
				defName = "Orassan_EcumenopolisB" or
				defName = "Orassan_Miner" or
				defName = "Orassan_Explorer" or
				defName = "Orassan_Mercenary" or
				defName = "Orassan_Cultist" or
				defName = "Orassan_Crafter" or
				defName = "Orassan_XenoZoo" or
				defName = "Orassan_Colinizer" or
				defName = "Orassan_Officer" or
				defName = "Orassan_NavyCook" or
				defName = "Orassan_Shellshocked" or
				defName = "Orassan_Hydro" or
				defName = "Orassan_Stripper" or
				defName = "Orassan_Pornstar" or
				defName = "Orassan_CapitalChild" or
				defName = "Orassan_GeneChild" or
				defName = "Orassan_SpacerChild" or
				defName = "Orassan_ColonyChild" or
				defName = "Orassan_Kyle" or
				defName = "Orassan_Stargazer" or
				defName = "Orassan_MilitaryC" or
				defName = "Orassan_GaiaChild" or
				defName = "Orassan_Ecumenopolis" or
				defName = "Orassan_Gravity" or
				defName = "Orassan_Climber" or
				defName = "Orassan_Mud"
				]/spawnCategories</xpath>
				<value>
					<li>OrassanSoldier</li>
				</value>
			</li>
		</operations>
	</Operation>
</Patch>
